---
import Layout from "../../layouts/Layout.astro";

export async function getStaticPaths() {
    const res = await fetch("http://localhost:1337/api/posts");
    const posts: { data: { slug: string }[] } = await res.json();

    return posts.data.map((post: { slug: string }) => ({
        params: { slug: post.slug },
    }));
}

const { slug } = Astro.params;
const res = await fetch(
    `http://localhost:1337/api/posts?filters[slug][$eq]=${slug}&populate=*`,
);
const data = await res.json();
const post = data.data[0];
console.log(post);

---

<Layout>
    <h1>Title: {post.title}</h1>
    <div>{post.content}</div>
</Layout>
