---
import "../styles/global.css";
import Favicons from "../components/Favicons.astro";
import Header from "../components/Header.astro";
import GoogleAnalytics from "../components/GoogleAnalytics.astro";
import NewsletterSignup from "../components/NewsletterSignup.astro";
import Footer from "../components/Footer.astro";
import SEO from "../components/SEO.astro";
import { fetchSingleType, fetchSiteSettings } from "../lib/api";

interface Props {
	pageTitle: string;
	description?: string;
	ogImage?: string;
	ogType?: 'website' | 'article';
	publishedTime?: string;
	authorName?: string;
	noindex?: boolean;
	siteName?: string;
}

const {
	pageTitle,
	description = '',
	ogImage,
	ogType = 'website',
	publishedTime,
	authorName,
	noindex = false,
	siteName,
} = Astro.props;

// Fetch home page content for newsletter FAB (shown on all pages)
const homePage = await fetchSingleType("home-page");
const siteSettings = await fetchSiteSettings();
---

<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<SEO
			title={pageTitle}
			description={description}
			ogImage={ogImage}
			ogType={ogType}
			publishedTime={publishedTime}
			authorName={authorName}
			noindex={noindex}
			siteName={siteName}
		/>
		<GoogleAnalytics />
		<Favicons />
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&display=swap"
			rel="stylesheet"
		/>
		<meta name="generator" content={Astro.generator} />
	</head>
	<body>
		<Header />
		<slot />
		<Footer
			tagline={siteSettings?.footerTagline}
			copyrightText={siteSettings?.copyrightText}
		/>
		<NewsletterSignup
			title={homePage?.newsletterTitle || "Subscribe to Hill People"}
			description={homePage?.newsletterDescription}
			buttonText={homePage?.newsletterButtonText}
			fabLabel={homePage?.newsletterFabLabel}
		/>
	</body>
</html>
