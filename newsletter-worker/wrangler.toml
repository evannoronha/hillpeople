name = "hillpeople-newsletter"
main = "src/index.ts"
compatibility_date = "2025-04-15"
compatibility_flags = ["nodejs_compat"]

[triggers]
crons = ["0 9 * * *"]  # Daily at 9 AM UTC

[[send_email]]
name = "EMAIL"
allowed_sender_addresses = ["web@hillpeople.net"]

[vars]
STRAPI_API_URL = "https://journal.hillpeople.net"
FRONTEND_URL = "https://hillpeople.net"
SENDER_EMAIL = "web@hillpeople.net"

# Secrets (set via `wrangler secret put`):
# - STRAPI_NEWSLETTER_TOKEN: API token for reading subscribers and updating posts
